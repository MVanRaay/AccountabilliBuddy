<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Create Goal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding-top: 1rem; padding-bottom: 1rem; }
        .form-label { font-weight: 500; }
        .form-control, .form-select { margin-bottom: 1rem; }
        .container { max-width: 480px; }
    </style>
</head>
<body>

<div th:replace="fragments/navbar :: navbar"></div>

<div class="container mt-5">
    <h2 class="mb-4 text-center">Create New Goal</h2>
    <form th:action="@{/goals/new}" method="post">
        <!-- Title -->
        <div class="mb-3">
            <label for="title" class="form-label">Goal Title</label>
            <input type="text" class="form-control" id="title" name="title" placeholder="Enter goal title" required>
        </div>

        <!-- Timeframe -->
        <div class="mb-3">
            <label for="timeFrame" class="form-label">Timeframe</label>
            <select class="form-select" id="timeFrame" name="timeFrame" required onchange="toggleEndDate()">
                <option value="" disabled selected>Select timeframe</option>
                <option value="Daily">Daily</option>
                <option value="Weely">Weekly</option>
                <option value="Bi-Weekly">Bi-Weekly</option>
                <option value="Monthly">Monthly</option>
                <option value="Once">Once</option>
            </select>
        </div>

        <!-- Completions per timeframe -->
        <div class="mb-3">
            <label for="completionsPerTimeFrame" class="form-label">Completions per timeframe</label>
            <input type="number" min="1" class="form-control" id="completionsPerTimeFrame" name="completionsPerTimeFrame" placeholder="e.g., 1, 2, 3" required>
        </div>

        <!-- End date (optional unless timeframe is ONCE) -->
        <div class="mb-3">
            <label for="endDate" class="form-label">End Date</label>
            <input type="date" class="form-control" id="endDate" name="endDate">
            <div class="form-text text-muted" id="endDateHelp">Optional unless timeframe is "Once".</div>
        </div>

        <button type="submit" class="btn btn-primary w-100">Create Goal</button>
    </form>
</div>

<script>
    function toggleEndDate() {
        const timeframe = document.getElementById('timeFrame').value;
        const endDateInput = document.getElementById('endDate');
        const helpText = document.getElementById('endDateHelp');

        if (timeframe === 'ONCE') {
            endDateInput.required = true;
            helpText.textContent = 'End date is required for one-time goals.';
        } else {
            endDateInput.required = false;
            helpText.textContent = 'Optional unless timeframe is "Once".';
        }
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
